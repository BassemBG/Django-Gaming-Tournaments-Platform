{% load static %}

<!doctype html>
<html lang="zxx">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Gaming</title>
    <link rel="icon" href="{% static 'gamesman/img/favicon.png' %}"> <!-- Use static for the favicon -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/bootstrap.min.css' %}">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/animate.css' %}">
    <!-- Owl carousel CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/owl.carousel.min.css' %}">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/all.css' %}">
    <!-- Flaticon CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/flaticon.css' %}">
    <link rel="stylesheet" href="{% static 'gamesman/css/themify-icons.css' %}">
    <!-- Magnific Popup CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/magnific-popup.css' %}">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/slick.css' %}">
    <!-- Style CSS -->
    <link rel="stylesheet" href="{% static 'gamesman/css/style.css' %}">
</head>

<style>
    .body_bg {
        background-color: #000000; /* Dark background for the body */
    }
    .table-custom {
        width: 80%; /* Increased width of the table */
        margin: -150px auto 20px auto; /* Negative margin-top to move it up slightly */
        background-color: rgb(254, 250, 250); /* Increased transparency for the table */
        color: rgb(0, 0, 0); /* White text color */
        border-radius: 8px; /* Rounded corners */
        overflow: hidden; /* Prevents border radius from being clipped */
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); /* Shadow effect */
    }
    .table-custom thead {
        background: linear-gradient(to right, red, #8B008B); /* Darker purple for the header */
    }
    .table-custom th {
        color: white; /* White text color for headers */
        padding: 20px; /* Increased padding for table header */
        text-align: center; /* Center text alignment */
        border: none; /* No border */
    }
    .table-custom th:hover {
        background: linear-gradient(to right, darkred, #4B0082); /* Darker gradient on hover */
    }
    .table-custom td {
        padding: 15px; /* Increased padding for table cells */
        text-align: center; /* Center text alignment */
        border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* Light border for separation */
    }
    .table-custom tr:hover {
        background-color: rgba(255, 255, 255, 0.1); /* Light hover effect on rows */
    }
    h1 {
        color: white; /* White color for the heading */
        margin-bottom: 20px; /* Space below the heading */
        text-align: center; /* Center the heading */
    }
</style>

<body>


<div class="body_bg">
    	<!--::header part start::-->
	<header class="main_menu single_page_menu">
		<div class="container">
			<div class="row align-items-center">
				<div class="col-lg-12">
					<nav class="navbar navbar-expand-lg navbar-light">
						<a class="navbar-brand" href=""> <img src="{% static 'img/logo.png' %}" alt="logo" height="200px" > </a>
						<button class="navbar-toggler" type="button" data-toggle="collapse"
							data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
							aria-expanded="false" aria-label="Toggle navigation">
							<span class="menu_icon"><i class="fas fa-bars"></i></span>
						</button>
						<div class="collapse navbar-collapse main-menu-item" id="navbarSupportedContent">
							<ul class="navbar-nav">
                                <li class="nav-item">
                                  <a class="nav-link" href="{% url 'home' %}">Home</a>
                                </li>
                                <li class="nav-item">
                                  <a class="nav-link" href="{% url 'Sponsors_form' %}"
                                    >sponsor a tournament</a
                                  >
                                </li>
                                <li class="nav-item">
                                  <a class="nav-link" href=" {% url 'Games_list' %}"
                                    >Our Games</a
                                  >
                                  <!-- Updated to use the ID -->
                                </li>
                                <li class="nav-item">
                                  <a class="nav-link" href=" {% url 'Tournaments_View' %}"
                                    >Our Tournaments</a
                                  >
                                  <!-- Updated to use the ID -->
                                </li>
                                <li class="nav-item">
                                  <a class="nav-link" href=" {% url 'chatbot_query' %}"
                                    >Ask Chatbot</a
                                  >
                                  <!-- Updated to use the ID -->
                                </li>
                                <li class="nav-item">
                                  <a class="nav-link" href=" {% url 'Equipments_View' %}"
                                    >Equipments</a
                                  >
                                </li>
                                <li class="nav-item">
                                  <a class="nav-link" href="#" onclick="startVoiceCommand()">
                                    üéôÔ∏è Voice Command
                                  </a>
                                </li>
                              </ul>
						</div>
						{% if user.is_authenticated %}
							<a href="{% url 'profile' user.cin %}" class="btn_1 d-none d-sm-block">Profile</a>
							<a href="{% url 'logout' %}" class="btn_1 d-none d-sm-block">Logout</a>
					{% else %}
						<a href="{% url 'login' %}" class="btn_1 d-none d-sm-block">Login</a>
						<a href="{% url 'register' %}" class="btn_1 d-none d-sm-block">SignUp</a>
					{% endif %}
						
					</nav>
				</div>
			</div>
		</div>
	</header>
	<!-- Header part end-->

    <section class="breadcrumb breadcrumb_bg">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="breadcrumb_iner text-center">
						<div class="breadcrumb_iner_item">
							<h2>Games</h2>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- breadcrumb start-->
   

     
        
         <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Game List</title>

            <!-- Include jQuery -->
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        
            <!-- Font Awesome for icons -->
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        
            <!-- Styling -->
            <style>
                body {
                    font-family: Arial, sans-serif;
                    background-color: #121212;
                    color: #ffffff;
                }
        
                .container {
                    padding: 20px;
                }
        
                h1 {
                    color: white;
                    margin-bottom: 20px;
                    text-align: center;
                }
        
                .filter-section {
                    margin-bottom: 20px;
                    text-align: center;
                }
        
                .game-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                    gap: 20px;
                    margin-top: 20px;
                }
        
                .game-card {
                    background: linear-gradient(145deg, #400080, #8a2be2);
                    border: 3px solid #ff007f;
                    border-radius: 8px;
                    padding: 15px;
                    box-shadow: 0 4px 15px rgba(255, 0, 127, 0.5);
                    transition: transform 0.2s;
                    color: #ffffff;
                }
        
                .game-card:hover {
                    transform: translateY(-5px);
                    box-shadow: 0 6px 20px rgba(255, 0, 127, 0.7);
                }
        
                /* Neon light blue for the game title */
                .game-card h3 {
                    margin: 0 0 10px;
                    font-size: 18px;
                    color: #00f0ff; /* Light Blue Neon Color */
                }
        
                /* Neon pink color for icons in the card */
                .game-card i {
                    color: #ff007f; /* Neon Pink Color */
                }
        
                .game-card p {
                    margin: 5px 0;
                    font-size: 14px;
                    color: #f0f0f0;
                }
        
                .filter-controls label,
                .sort-controls a {
                    margin-right: 10px;
                    color: #ff007f;
                }
        
                .filter-controls select,
                #search-box {
                    padding: 5px;
                    border: 1px solid #ff007f;
                    border-radius: 4px;
                    background-color: #400080;
                    color: #ffffff;
                }
        
                .no-results {
                    text-align: center;
                    font-size: 18px;
                    color: #ff007f;
                    margin-top: 50px;
                }
            </style>
</head>

<body>
    <div class="container">
        <!-- Filter and Sort Controls -->
        <div class="filter-section">
            <div class="filter-controls">
                <label for="search-box">Search:</label>
                <input type="text" id="search-box" placeholder="Search by game title..." />

                <label for="platformFilter">Platform:</label>
                <select id="platformFilter">
                    <option value="">All</option>
                    <option value="PC">PC</option>
                    <option value="Xbox">Xbox</option>
                    <option value="PlayStation">PlayStation</option>
                </select>

                <label for="publisherFilter">Publisher:</label>
                <select id="publisherFilter">
                    <option value="">All</option>
                    <option value="Rockstar Games">Rockstar Games</option>
                    <option value="Electronic Arts (EA)">Electronic Arts (EA)</option>
                    <option value="Ubisoft">Ubisoft</option>
                </select>

                <label for="developerFilter">Developer:</label>
                <select id="developerFilter">
                    <option value="">All</option>
                    <option value="Naughty Dog">Naughty Dog</option>
                    <option value="Ubisoft">Ubisoft</option>
                </select>
            </div>

            <div class="sort-controls">
                <a href="#" id="sort-players-asc">Sort by Players (Ascending)</a>
                <a href="#" id="sort-players-desc">Sort by Players (Descending)</a>
                <a href="#" id="reset-sort">Reset Sort</a>
            </div>
        </div>

        <!-- Game Grid -->
        <h1>Our Games</h1>
        <div id="games-body" class="game-grid">
            <!-- Dynamic Game Cards will be rendered here -->
        </div>

        <p class="no-results" id="no-results" style="display: none;">No games found.</p>
    </div>

    <!-- jQuery -->
    <script>
    // Function to dynamically update game display
    function updateDisplay(games) {
        const gamesBody = $('#games-body');
        const noResults = $('#no-results');

        gamesBody.empty(); // Clear the game grid

        if (games.length > 0) {
            noResults.hide();
            games.forEach(function (game) {
                const gameCard = `
                    <div class="game-card">
                        <h3><i class="fas fa-gamepad"></i> ${game.Game_Title}</h3>
                        <p><i class="fas fa-tags"></i> <strong>Genre:</strong> ${game.Genre}</p>
                        <p><i class="fas fa-laptop"></i> <strong>Platform:</strong> ${game.Platform}</p>
                        <p><i class="fas fa-calendar-alt"></i> <strong>Release Date:</strong> ${game.Release_Date}</p>
                        <p><i class="fas fa-code"></i> <strong>Developer:</strong> ${game.Developer}</p>
                        <p><i class="fas fa-building"></i> <strong>Publisher:</strong> ${game.Publisher}</p>
                        <p><i class="fas fa-users"></i> <strong>Players:</strong> ${game.Nb_Players}</p>
                        <p><i class="fas fa-hdd"></i> <strong>File Size:</strong> ${game.File_Size}</p>
                    </div>`;
                gamesBody.append(gameCard); // Append each game card
            });
        } else {
            noResults.show(); // Show no results message if no games are found
        }
    }

    $(document).ready(function () {
        // Function to fetch and filter data from the backend
        function fetchData(params) {
            $.ajax({
                url: '{% url "search_games" %}', // Replace with the correct Django view name
                data: params,
                dataType: 'json',
                success: function (data) {
                    updateDisplay(data.games); // Update game display with fetched data
                },
                error: function () {
                    alert('Error fetching data.');
                },
            });
        }

        // Initial Load (fetch all games)
        fetchData({});

        // Search functionality - triggered as user types
        $('#search-box').on('input', function () {
            const searchQuery = $(this).val(); // Get search box value
            fetchData({ q: searchQuery }); // Send search query to backend (use 'q' instead of 'search')
        });

        // Filter functionality
        $('#platformFilter, #publisherFilter, #developerFilter').change(function () {
            const platform = $('#platformFilter').val();
            const publisher = $('#publisherFilter').val();
            const developer = $('#developerFilter').val();
            fetchData({ platform, publisher, developer });
        });

        // Sorting functionality - Sort by players
        $('#sort-players-asc').click(function (e) {
            e.preventDefault();
            fetchData({ sort: 'players_asc' });
        });

        $('#sort-players-desc').click(function (e) {
            e.preventDefault();
            fetchData({ sort: 'players_desc' });
        });

        // Reset sorting
        $('#reset-sort').click(function (e) {
            e.preventDefault();
            fetchData({});
        });
    });
    let currentPage = 1;  // Keep track of the current page number

// Function to dynamically update game display
function updateDisplay(games, numPages) {
    const gamesBody = $('#games-body');
    const noResults = $('#no-results');
    const pageNum = $('#page-num');

    gamesBody.empty(); // Clear the game grid

    if (games.length > 0) {
        noResults.hide();
        games.forEach(function (game) {
            const gameCard = `
                <div class="game-card">
                    <h3><i class="fas fa-gamepad"></i> ${game.Game_Title}</h3>
                    <p><i class="fas fa-tags"></i> <strong>Genre:</strong> ${game.Genre}</p>
                    <p><i class="fas fa-laptop"></i> <strong>Platform:</strong> ${game.Platform}</p>
                    <p><i class="fas fa-calendar-alt"></i> <strong>Release Date:</strong> ${game.Release_Date}</p>
                    <p><i class="fas fa-code"></i> <strong>Developer:</strong> ${game.Developer}</p>
                    <p><i class="fas fa-building"></i> <strong>Publisher:</strong> ${game.Publisher}</p>
                    <p><i class="fas fa-users"></i> <strong>Players:</strong> ${game.Nb_Players}</p>
                    <p><i class="fas fa-hdd"></i> <strong>File Size:</strong> ${game.File_Size}</p>
                </div>`;
            gamesBody.append(gameCard); // Append each game card
        });
        pageNum.text('Page ' + currentPage);
    } else {
        noResults.show(); // Show no results message if no games are found
    }

    // Update pagination buttons visibility
    $('#prev-page').prop('disabled', currentPage === 1);
    $('#next-page').prop('disabled', currentPage === numPages);
}

// Function to fetch and filter data from the backend
function fetchData(params) {
    $.ajax({
        url: '{% url "search_games" %}', // Replace with the correct Django view name
        data: {...params, page: currentPage}, // Include the current page number
        dataType: 'json',
        success: function (data) {
            updateDisplay(data.games, data.num_pages); // Update game display with fetched data
        },
        error: function () {
            alert('Error fetching data.');
        },
    });
}

// Pagination buttons functionality
function changePage(direction) {
    if (direction === 'prev' && currentPage > 1) {
        currentPage--;
    } else if (direction === 'next') {
        currentPage++;
    }

    fetchData({}); // Fetch data for the new page
}

$(document).ready(function () {
    // Initial Load (fetch all games)
    fetchData({});

    // Search functionality
    $('#search-box').on('input', function () {
        const searchQuery = $(this).val();
        fetchData({ q: searchQuery });
    });

    // Filter functionality
    $('#platformFilter, #publisherFilter, #developerFilter').change(function () {
        const platform = $('#platformFilter').val();
        const publisher = $('#publisherFilter').val();
        const developer = $('#developerFilter').val();
        fetchData({ platform, publisher, developer });
    });

    // Sorting functionality - Sort by players
    $('#sort-players-asc').click(function (e) {
        e.preventDefault();
        fetchData({ sort: 'players_asc' });
    });

    $('#sort-players-desc').click(function (e) {
        e.preventDefault();
        fetchData({ sort: 'players_desc' });
    });

    // Reset sorting
    $('#reset-sort').click(function (e) {
        e.preventDefault();
        fetchData({});
    });
});
</script>

        
        
       

        <!--::footer_part start::-->
        <footer class="footer_part">
            <div class="footer_top">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-6 col-lg-3">
                            <div class="single_footer_part">
                                <a href="index.html" class="footer_logo_iner"> <img src="img/logo.png" alt="#"> </a>
                                <p>Heaven fruitful doesn't over lesser days appear creeping seasons so behold bearing
                                    days
                                    open
                                </p>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="single_footer_part">
                                <h4>Contact Info</h4>
                                <p>Address : Your address goes
                                    here, your demo address.
                                    Bangladesh.</p>
                                <p>Phone : +8880 44338899</p>
                                <p>Email : info@colorlib.com</p>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="single_footer_part">
                                <h4>Important Link</h4>
                                <ul class="list-unstyled">
                                    <li><a href=""> WHMCS-bridge</a></li>
                                    <li><a href="">Search Domain</a></li>
                                    <li><a href="">My Account</a></li>
                                    <li><a href="">Shopping Cart</a></li>
                                    <li><a href="">Our Shop</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-sm-6 col-lg-3">
                            <div class="single_footer_part">
                                <h4>Newsletter</h4>
                                <p>Heaven fruitful doesn't over lesser in days. Appear creeping seasons deve behold
                                    bearing
                                    days
                                    open
                                </p>
                                <div id="mc_embed_signup">
                                    <form target="_blank"
                                        action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                                        method="get" class="subscribe_form relative mail_part">
                                        <input type="email" name="email" id="newsletter-form-email"
                                            placeholder="Email Address" class="placeholder hide-on-focus"
                                            onfocus="this.placeholder = ''"
                                            onblur="this.placeholder = ' Email Address '">
                                        <button type="submit" name="submit" id="newsletter-submit"
                                            class="email_icon newsletter-submit button-contactForm"><i
                                                class="far fa-paper-plane"></i></button>
                                        <div class="mt-10 info"></div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="copygight_text">
                <div class="container">
                    <div class="row align-items-center">
                        <div class="col-lg-8">
                            <div class="copyright_text">
                                <P><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="ti-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. --></P>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="footer_icon social_icon">
                                <ul class="list-unstyled">
                                    <li><a href="#" class="single_social_icon"><i class="fab fa-facebook-f"></i></a>
                                    </li>
                                    <li><a href="#" class="single_social_icon"><i class="fab fa-twitter"></i></a></li>
                                    <li><a href="#" class="single_social_icon"><i class="fas fa-globe"></i></a></li>
                                    <li><a href="#" class="single_social_icon"><i class="fab fa-behance"></i></a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!--::footer_part end::-->
    </div>


    <!-- jquery plugins here-->
    <script src="js/jquery-1.12.1.min.js"></script>
    <!-- popper js -->
    <script src="js/popper.min.js"></script>
    <!-- bootstrap js -->
    <script src="js/bootstrap.min.js"></script>
    <!-- easing js -->
    <script src="js/jquery.magnific-popup.js"></script>
    <!-- swiper js -->
    <script src="js/swiper.min.js"></script>
    <!-- swiper js -->
    <script src="js/masonry.pkgd.js"></script>
    <!-- particles js -->
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <!-- slick js -->
    <script src="js/slick.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>
    <!-- custom js -->
    <script src="js/custom.js"></script>
</body>
<script>
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();

            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });
</script>

</html>

      <!-- Script START for voice commands -->
      <script>
        // Helper function to get CSRF token
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== "") {
                const cookies = document.cookie.split(";");
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === name + "=") {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        const csrftoken = getCookie("csrftoken");
    
        async function startVoiceCommand() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    
            if (!SpeechRecognition) {
                alert("Your browser does not support the Web Speech API. Please use Chrome or Edge.");
                return;
            }
    
            const recognition = new SpeechRecognition();
            recognition.lang = "en-US";
            recognition.interimResults = false;
            recognition.maxAlternatives = 1;
    
            recognition.start();
    
            recognition.onresult = async (event) => {
                const transcript = event.results[0][0].transcript;
    
                try {
                    // Step 1: Send transcript to classify the command
                    const classifyResponse = await fetch("/api/voice-command/", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "X-CSRFToken": csrftoken,
                        },
                        body: JSON.stringify({ text: transcript }),
                    });
    
                    const classifyResult = await classifyResponse.json();
                    if (classifyResult.error) {
                        alert(`Error: ${classifyResult.error}`);
                        return;
                    }
    
                    const { command } = classifyResult;
    
                    // Step 2: Get the resolved URL
                    const redirectResponse = await fetch("/api/voice-command-redirect/", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "X-CSRFToken": csrftoken,
                        },
                        body: JSON.stringify({ command }),
                    });
    
                    const redirectResult = await redirectResponse.json();
                    if (redirectResult.redirect_url) {
                        // Redirect to the resolved URL
                        window.location.href = redirectResult.redirect_url;
                    } else if (redirectResult.error) {
                        alert(`Error: ${redirectResult.error}`);
                    }
                } catch (error) {
                    alert(`Error: ${error.message}`);
                }
            };
    
            recognition.onerror = (event) => {
                alert(`Error: ${event.error}`);
            };
        }
      </script>
      <!-- Script END for voice commands -->